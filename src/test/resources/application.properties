# Use the H2 in-memory database for all tests
spring.datasource.url=jdbc:h2:mem:testdb
spring.datasource.driverClassName=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=password
spring.jpa.hibernate.naming.physical-strategy=org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl
# This is the most important line for fixing your issue.
# It tells Hibernate to CREATE all tables from your @Entity classes when tests start,
# and DROP them all when tests finish. This guarantees a clean database for every run.
spring.jpa.hibernate.ddl-auto=create-drop

# Optional: Prevents the main data.sql from running during tests if it causes issues.
# You might not need this line, but it can be useful.
# spring.sql.init.mode=never
# THE FIX: Wait for Hibernate to create tables before running data.sql
spring.jpa.defer-datasource-initialization=true